<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Product List</title>
    <style>
        table {
            width: 600px;
            height: 20px;
        }

        #error {
            color: red;
        }
    </style>
</head>
<body>
<div>
    <div>
        <h3 id="header_add" style="display: inline-block">Add new product</h3>
        <h3 id="header_edit" style="display: none">Edit product</h3><br>
        <label for="input"></label>
        <input id="input" type="text" placeholder="Nhập tên sản phẩm">
        <button id="addBtn" onclick="addProduct()">ADD</button>
        <button id="saveBtn" onclick="saveProduct()"
                style="display:none;border-radius: 24% 76% 26% 74% / 68% 16% 84% 32% ">SAVE
        </button>
    </div>
    <p id="error"></p>
    <div>
        <table>
            <tr>
                <td><h3>Product name</h3></td>
                <td></td>
                <td><p id="result_all_product">products</p></td>
            </tr>
        </table>
    </div>
    <div>
        <h3>Display all Product</h3>
        <div id="result"></div>
    </div>
</div>

<script>
    let danhSachSanPham = [];
    let error = document.getElementById("error");

    function addProduct() {
        let ten = document.getElementById("input").value;
        if (ten.trim() !== "") {
            danhSachSanPham.push(ten);
            document.getElementById("input").value = "";
            error.innerHTML = "";
            display();
            allProduct();
        } else {
            error.innerHTML = "Lỗi";
        }
    }

    function display() {
        let tableString = `<table>`;
        for (let i = 0; i < danhSachSanPham.length; i++) {
            tableString += `<tr>
                         <td>${danhSachSanPham[i]}</td>
                         <td><button onclick="editProduct(${i})">Edit</button></td>
                         <td><button onclick="deleteProduct(${i})">Delete</button></td>
                      </tr>`;
        }
        tableString += "</table>";
        document.getElementById("result").innerHTML = tableString;
    }

    let editingIndex = -1;

    function editProduct(index) {
        document.getElementById("input").value = danhSachSanPham[index];
        editingIndex = index;
        document.getElementById("header_add").style.display = "none";
        document.getElementById("header_edit").style.display = "inline-block";
        document.getElementById("addBtn").style.display = "none";
        document.getElementById("saveBtn").style.display = "inline-block";
    }

    function saveProduct() {
        let newName = document.getElementById("input").value.trim();
        if (confirm("bạn xác nhận muốn sửa không?")) {
            if (editingIndex !== -1 && newName !== "") {
                danhSachSanPham[editingIndex] = newName;
                editingIndex = -1
                document.getElementById("input").value = "";
                display();
                allProduct();
            }
            document.getElementById("header_add").style.display = "inline-block";
            document.getElementById("header_edit").style.display = "none";
            document.getElementById("addBtn").style.display = "inline-block";
            document.getElementById("saveBtn").style.display = "none";
        }
    }

    function deleteProduct(index) {
        danhSachSanPham.splice(index, 1);
        display();
        allProduct();
    }

    function allProduct() {
        document.getElementById("result_all_product").innerHTML = `${danhSachSanPham.length} products`;
    }
</script>
</body>
</html>
